apiVersion: batch/v1
kind: Job
metadata:
  name: nj-job1
  annotations:
    helm.sh/hook: post-install, post-upgrade
    helm.sh/hook-weight: "1"
    helm.sh/hook-delete-policy: before-hook-creation
spec:
  template:
    spec:
      containers:
      - name: job
        image: busybox
        command: ["sh", "-c", "sleep 30 && echo Running job in wave 0"]
      restartPolicy: Never
# ---
# apiVersion: batch/v1
# kind: Job
# metadata:
#   name: nj-my-job-wave-1
#   annotations:
#     argocd.argoproj.io/hook: PostSync
# spec:
#   template:
#     spec:
#       containers:
#       - name: job
#         image: busybox
#         command: ["sh", "-c", "sleep 600 && echo Running job in wave 1"]
#       restartPolicy: Never
# ---
# apiVersion: batch/v1
# kind: Job
# metadata:
#   name: my-job-wave-2
#   annotations:
#     argocd.argoproj.io/hook: PostSync
#     argocd.argoproj.io/hook-deletion-policy: HookSucceeded
#     argocd.argoproj.io/sync-wave: "2"
# spec:
#   template:
#     spec:
#       containers:
#       - name: job
#         image: busybox
#         command: ["sh", "-c", "sleep 600 && echo Running job in wave 2"]
#       restartPolicy: Never
# ---
# apiVersion: batch/v1
# kind: Job
# metadata:
#   name: my-job-wave-3
#   annotations:
#     argocd.argoproj.io/hook: PostSync
#     argocd.argoproj.io/hook-deletion-policy: HookSucceeded
#     argocd.argoproj.io/sync-wave: "3"
# spec:
#   template:
#     spec:
#       containers:
#       - name: job
#         image: busybox
#         command: ["sh", "-c", "sleep 600 && echo Running job in wave 3"]
#       restartPolicy: Never
