# -----------------------------
# Global/shared configuration
# -----------------------------
replicaCount: 1
env: "prod"
timezone: "UTC"

image:
  repository: "quay.io/us-cdcgov/cdc-nbs-modernization/data-reporting-service"
  tag: "v1.1.8"
  pullPolicy: IfNotPresent

imagePullSecrets: []

jdbc:
  username: ""
  password: ""

odse:
  dburl: ""


kafka:
  cluster: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations:
  prometheus.io/scrape: "true"
  prometheus.io/path: "/actuator/prometheus"
  prometheus.io/port: "8081"

resources: 
  limits:
    memory: "512Mi"  
    cpu: "250m"      
  requests:
    memory: "256Mi"  
    cpu: "125m"
    
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80

nodeSelector: {}
tolerations: []
affinity: {}

probes:
  readiness:
    enabled: true
  liveness:
    enabled: true

# -----------------------------
# Per-service configuration
# -----------------------------
services:

  investigation-reporting:
    service:
      port: 8093
      httpsPort: 443

    serviceAccount:
      create: true
      name: ""          # Optional, leave empty to auto-generate
      annotations: {}

    featureFlag:
      phcDatamartEnable: "true"
      bmirdCaseEnable: "true"
      contactRecordEnable: "true"
      treatmentEnable: "false"

    log:
      path: "/usr/share/investigation-reporting/data"

    probes:
      readiness:
        enabled: true
        path: "/reporting/investigation-svc/status"
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: "/reporting/investigation-svc/status"
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5

  ldfdata-reporting:
    service:
      port: 8097
      httpsPort: 443

    serviceAccount:
      create: true
      name: ""          # Optional, leave empty to auto-generate
      annotations: {}

    log:
      path: "/usr/share/ldfdata-reporting/data"
    probes:
      readiness:
        enabled: true
        path: "/reporting/ldfdata-svc/status"
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: "/reporting/ldfdata-svc/status"
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5

  observation-reporting:
    service:
      port: 8094
      httpsPort: 443

    serviceAccount:
      create: true
      name: ""          # Optional, leave empty to auto-generate
      annotations: {}

    log:
      path: "/usr/share/observation-reporting/data"

    probes:
      readiness:
        enabled: true
        path: "/reporting/observation-svc/status"
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: "/reporting/observation-svc/status"
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5

  organization-reporting:
    service:
      port: 8092
      httpsPort: 443

    serviceAccount:
      create: true
      name: ""          # Optional, leave empty to auto-generate
      annotations: {}

    log:
      path: "/usr/share/organization-reporting/data"

    probes:
      readiness:
        enabled: true
        path: "/reporting/organization-svc/status"
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: "/reporting/organization-svc/status"
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5

  person-reporting:
    service:
      port: 8091
      httpsPort: 443

    serviceAccount:
      create: true
      name: ""          # Optional, leave empty to auto-generate
      annotations: {}

    log:
      path: "/usr/share/person-reporting/data"
    probes:
      readiness:
        enabled: true
        path: "/reporting/person-svc/status"
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: "/reporting/person-svc/status"
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5

  post-processing-reporting:
    service:
      port: 8095
      httpsPort: 443
      fixedDelay:
        cachedIds: 2

    serviceAccount:
      create: true
      name: ""          # Optional, leave empty to auto-generate
      annotations: {}
    rdb:
        dburl: ""
    log:
        path: "/usr/share/post-processing-reporting/data"
    featureFlag:
      covidDmEnable: "false"
    probes:
      readiness:
        enabled: true
        path: "/reporting/post-processing-svc/status"
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: "/reporting/post-processing-svc/status"
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5