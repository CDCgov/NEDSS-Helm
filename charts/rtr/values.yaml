# ================================================
# Global configuration
# ================================================

replicaCount: 1
env: prod              # Environment indicator
timezone: UTC          # Container timezone

jdbc:
  username: ''         # DB username (should be set in secrets)
  password: ''         # DB password (should be set in secrets)

odse:
  dburl: ''            # ODSE DB URL

kafka:
  cluster: ''          # Kafka cluster bootstrap servers

serviceAccount:
  create: true
  annotations: {}
  name: ''

podAnnotations:
  prometheus.io/scrape: 'true'
  prometheus.io/path: /actuator/prometheus
  prometheus.io/port: '8081'

resources:
  limits:
    memory: 1Gi        # Memory limit per pod
    cpu: 500m          # CPU limit per pod
  requests:
    memory: 512Mi      # Memory request per pod
    cpu: 250m          # CPU request per pod

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80

nodeSelector: {}
tolerations: []
affinity: {}

probes:
  readiness:
    enabled: true      # Enable readiness probe
  liveness:
    enabled: true      # Enable liveness probe

# ================================================
# Service-specific configurations
# ================================================
services:

  # ----------------------------------------
  # Investigation Reporting Service
  # ----------------------------------------
  investigation-reporting:
    service:
      port: 8093
      httpsPort: 443
    serviceAccount:
      create: true
      name: ''
      annotations: {}
    featureFlag:
      phcDatamartEnable: 'true'
    log:
      path: /usr/share/investigation-reporting/data
    probes:
      readiness:
        enabled: true
        path: /reporting/investigation-svc/status
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: /reporting/investigation-svc/status
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5
    image:
      repository: 501715613725.dkr.ecr.us-east-1.amazonaws.com/cdc-nbs-modernization/data-reporting-service
      name: investigation-reporting-service
      tag: 1.0.1-SNAPSHOT.9459a0c
      pullPolicy: IfNotPresent

  # ----------------------------------------
  # LDF Data Reporting Service
  # ----------------------------------------
  ldfdata-reporting:
    service:
      port: 8097
      httpsPort: 443
    serviceAccount:
      create: true
      name: ''
      annotations: {}
    log:
      path: /usr/share/ldfdata-reporting/data
    probes:
      readiness:
        enabled: true
        path: /reporting/ldfdata-svc/status
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: /reporting/ldfdata-svc/status
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5
    image:
      repository: 501715613725.dkr.ecr.us-east-1.amazonaws.com/cdc-nbs-modernization/data-reporting-service
      name: ldfdata-reporting-service
      tag: 1.0.1-SNAPSHOT.9459a0c
      pullPolicy: IfNotPresent

  # ----------------------------------------
  # Observation Reporting Service
  # ----------------------------------------
  observation-reporting:
    service:
      port: 8094
      httpsPort: 443
    serviceAccount:
      create: true
      name: ''
      annotations: {}
    log:
      path: /usr/share/observation-reporting/data
    probes:
      readiness:
        enabled: true
        path: /reporting/observation-svc/status
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: /reporting/observation-svc/status
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5
    image:
      repository: 501715613725.dkr.ecr.us-east-1.amazonaws.com/cdc-nbs-modernization/data-reporting-service
      name: observation-reporting-service
      tag: 1.0.1-SNAPSHOT.9459a0c
      pullPolicy: IfNotPresent

  # ----------------------------------------
  # Organization Reporting Service
  # ----------------------------------------
  organization-reporting:
    service:
      port: 8092
      httpsPort: 443
    serviceAccount:
      create: true
      name: ''
      annotations: {}
    log:
      path: /usr/share/organization-reporting/data
    probes:
      readiness:
        enabled: true
        path: /reporting/organization-svc/status
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: /reporting/organization-svc/status
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5
    image:
      repository: 501715613725.dkr.ecr.us-east-1.amazonaws.com/cdc-nbs-modernization/data-reporting-service
      name: organization-reporting-service
      tag: 1.0.1-SNAPSHOT.9459a0c
      pullPolicy: IfNotPresent

  # ----------------------------------------
  # Person Reporting Service
  # ----------------------------------------
  person-reporting:
    service:
      port: 8091
      httpsPort: 443
    serviceAccount:
      create: true
      name: ''
      annotations: {}
    featureFlag:
      elasticSearchEnable: 'true'
      covidDmEnable: 'false'
    log:
      path: /usr/share/person-reporting/data
    probes:
      readiness:
        enabled: true
        path: /reporting/person-svc/status
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: /reporting/person-svc/status
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5
    image:
      repository: 501715613725.dkr.ecr.us-east-1.amazonaws.com/cdc-nbs-modernization/data-reporting-service
      name: person-reporting-service
      tag: 1.0.1-SNAPSHOT.9459a0c
      pullPolicy: IfNotPresent

  # ----------------------------------------
  # Post-Processing Reporting Service
  # ----------------------------------------
  post-processing-reporting:
    service:
      port: 8095
      httpsPort: 443
      fixedDelay:
        cachedIds: 2
    serviceAccount:
      create: true
      name: ''
      annotations: {}
    rdb:
      dburl: ''
    log:
      path: /usr/share/post-processing-reporting/data
    probes:
      readiness:
        enabled: true
        path: /reporting/post-processing-svc/status
        initialDelaySeconds: 30
        periodSeconds: 10
        failureThreshold: 5
      liveness:
        enabled: true
        path: /reporting/post-processing-svc/status
        initialDelaySeconds: 60
        periodSeconds: 30
        failureThreshold: 5
    image:
      repository: 501715613725.dkr.ecr.us-east-1.amazonaws.com/cdc-nbs-modernization/data-reporting-service
      name: post-processing-reporting-service
      tag: 1.0.1-SNAPSHOT.9459a0c
      pullPolicy: IfNotPresent
    featureFlag:
      covidDmEnable: 'false'
